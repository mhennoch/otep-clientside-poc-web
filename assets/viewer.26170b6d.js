var z=Object.defineProperty,F=Object.defineProperties;var A=Object.getOwnPropertyDescriptors;var b=Object.getOwnPropertySymbols;var B=Object.prototype.hasOwnProperty,Z=Object.prototype.propertyIsEnumerable;var D=(n,e,t)=>e in n?z(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,v=(n,e)=>{for(var t in e||(e={}))B.call(e,t)&&D(n,t,e[t]);if(b)for(var t of b(e))Z.call(e,t)&&D(n,t,e[t]);return n},w=(n,e)=>F(n,A(e));import{I as G,g as E,_ as U}from"./plugin-vue_export-helper.aa4e3a92.js";import{w as V,Z as M,_ as W,$ as y,K as I,y as _,z as m,A as u,H as O,J as Y,a0 as g,Q as c,G as $,M as h,N as x,a1 as j,a2 as P,a3 as Q,a4 as X,a5 as q,a6 as ee,a7 as N,a8 as T,a9 as L,U as se,aa as te,Y as ne}from"./vendor.67b33145.js";const oe={class:"p-2"},ae={class:"list-disc ml-6"},re={class:"text-sm"},ie=c(" ("),le=c(") "),ce=c(" raw data "),ue=c(" | "),de=c(" timeline "),pe=V({setup(n){const e=M(W(G,{},{deep:!1,shallow:!0,writeDefaults:!1})),t=y(()=>Object.entries(e.value).map(([s,a])=>v({sessionId:s,lastDataTime:new Date(a.lastData)},a)).sort((s,a)=>a.lastData-s.lastData));return(i,s)=>{const a=I("RouterLink");return _(),m("div",oe,[u("ul",ae,[(_(!0),m(O,null,Y(g(t),r=>(_(),m("li",null,[c($(r.sessionId)+" ",1),u("span",re,[ie,h(g(j),{time:r.lastDataTime},{default:x(({timeAgo:d})=>[c($(d),1)]),_:2},1032,["time"]),le]),h(a,{to:{name:"session.view",params:{sessionId:r.sessionId}}},{default:x(()=>[ce]),_:2},1032,["to"]),ue,h(a,{to:{name:"session.timeline",params:{sessionId:r.sessionId}}},{default:x(()=>[de]),_:2},1032,["to"])]))),256))])])}}});function C(n){return P({spans:k(y(()=>E("spans",g(n))),_e),logs:k(y(()=>E("logs",g(n))),me)})}function k(n,e){const t=Q([]);function i(s){if(!(s&&s.key!==n.value))try{const a=s?s.newValue:localStorage.getItem(n.value);if(!a){t.value=[];return}t.value=e(a)}catch(a){console.error("Error parsing localstorage",n.value,a)}}return i(),X(window,"storage",s=>setTimeout(()=>i(s),0)),t}function _e(n){const e=JSON.parse(n),t=[];return e.forEach(({resource:i,instrumentationLibrarySpans:s})=>{s.forEach(({instrumentationLibrary:a,spans:r})=>{r.forEach(d=>{t.push(w(v({},d),{instrumentationLibrary:a,resource:i}))})})}),t}function me(n){const e=JSON.parse(n),t=[];return e.forEach(({resource:i,instrumentationLibraryLogs:s})=>{s.forEach(({instrumentationLibrary:a,logRecords:r})=>{r.forEach(d=>{t.push(w(v({},d),{instrumentationLibrary:a,resource:i}))})})}),t}const he={class:"font-mono"},fe=V({props:{sessionId:null},setup(n){const t=C(q(n,"sessionId"));return(i,s)=>(_(),m("div",null,[u("pre",he,$(g(t).spans),1)]))}});let f,R,H;const ge={props:{sessionId:String},data(){return{spans:!0,logs:!0}},mounted(){f=new ee(this.$refs.container);var n={verticalScroll:!0,zoomKey:"shiftKey",groupOrder:function(e,t){return e.id-t.id}};f.setOptions(n),S(this.sessionId,this.spans,this.logs)},methods:{toggleSpans(){this.spans=!this.spans,S(this.sessionId,this.spans,this.logs)},toggleLogs(){this.logs=!this.logs,S(this.sessionId,this.spans,this.logs)},resetZoom(){f.setWindow(R,H)}}};function S(n,e,t){const i=C(n);let s=[];if(e){var a=i.spans.map((o,l)=>({id:o.spanId,className:o.name,content:o.name,start:o.startTimeUnixNano/1e6,end:o.endTimeUnixNano/1e6,title:`${o.name} - ${(o.startTimeUnixNano/1e6).toFixed(1)} - ${(o.endTimeUnixNano/1e6-o.startTimeUnixNano/1e6).toFixed(1)}ms`}));s=s.concat(a)}if(t){let o=0;const l=i.logs.map(p=>({id:o++,content:p.attributes.find(K=>K.key==="event.name").value.stringValue,start:p.timeUnixNano/1e6,type:"point"}));s=s.concat(l)}s.sort((o,l)=>o.start-l.start),s.forEach((o,l)=>{o.group=l});function r(){const o=JSON.parse(JSON.stringify(s));return o.sort((l,p)=>(p.end||p.start)-(l.end||l.start)),o[0]}var d=new N;if(s.forEach((o,l)=>{d.add({id:l,content:o.content})}),f.setGroups(d),f.setItems(new N(s)),s.length>0){const o=r(),l=o.end||o.start,p=(o.end||o.start)-s[0].start;R=s[0].start,H=l+p*.1}}const ve=c("spans "),xe=c("logs "),we=u("br",null,null,-1),Se=c(" Hold SHIFT to zoom "),ye={ref:"container"};function Ie(n,e,t,i,s,a){return _(),m(O,null,[T(u("input",{type:"checkbox",name:"spans","onUpdate:modelValue":e[0]||(e[0]=r=>s.spans=r),onClick:e[1]||(e[1]=r=>a.toggleSpans())},null,512),[[L,s.spans]]),ve,T(u("input",{type:"checkbox",name:"logs","onUpdate:modelValue":e[2]||(e[2]=r=>s.logs=r),onClick:e[3]||(e[3]=r=>a.toggleLogs())},null,512),[[L,s.logs]]),xe,u("button",{onClick:e[4]||(e[4]=r=>a.resetZoom())},"reset zoom"),we,Se,u("div",ye,null,512)],64)}var $e=U(ge,[["render",Ie]]);const be=[{path:"/",name:"session.list",component:pe},{path:"/view/:sessionId",name:"session.view",component:fe,props:!0},{path:"/timeline/:sessionId",name:"session.timeline",component:$e,props:!0}];var De=se({history:te(),routes:be});const Ee={},Ne={class:"flex flex-col h-screen w-screen overflow-hidden"},Te={class:"h-12 flex-initial flex border-gray-500 border-b"},Le=c(" Sessions List "),ke={class:"flex-1 overflow-auto"};function Ue(n,e){const t=I("router-link"),i=I("router-view");return _(),m("div",Ne,[u("div",Te,[h(t,{class:"block p-2 bg-transparent hover:bg-gray-100 hover:text-gray-800",to:"/","exact-active-class":"bg-gray-100 text-blue-600 hover:text-blue-600"},{default:x(()=>[Le]),_:1})]),u("div",ke,[h(i)])])}var Ve=U(Ee,[["render",Ue]]);const J=ne(Ve);J.use(De);J.mount("#app");
